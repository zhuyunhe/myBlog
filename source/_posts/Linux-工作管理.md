---
title: Linux-工作管理
date: 2016-06-07 10:40:25
tags:
- Linux
- 学习
categories: 学习笔记
---
# 工作管理（job control）
工作管理是用在bash环境下的，也就是当我们登录系统取得bash shell之后，在单一终端机下同时进行多个工作的行为管理。<!-- more -->
在学习工作管理常用命令前，先建立几个概念：  
1.这些工作所触发的进程必须来自于你shell的子进程，只管理自己的bash的工作，而不能去管理其他bash的工作。  
2.前台：你可以控制与执行命令的这个环境称为前台（foreground）的工作。  
3.后台：可以自动运行的工作，你无法使用[ctrl]+c终止它，可以使用bg/fg调用改工作。  
4.后台中“执行”的进程不能等待terminal/shell的输入（input）。  

## 实际进行job控制的命令
- 直接将命令丢到后台中执行的&  
输入一个命令后，在该命令的最后加上一个“&”（注意前面加个空格）代表将该命令丢到后台中去执行，此时bash会给予这个命令一个“工作号码”(job number).这样做最大的好处就是不用担心执行时被[ctrl]+c中断。  
`[1] 8890` <== 中括号里的1就是工作号，8890是该命令触发的PID。  
这个工作号码只与当前这个bash环境有关，但它既然是一个命令触发的，所以当然一定是一个进程，因此也会搭配着一个PID。  

- 将目前的工作丢到后台中“暂停”:[ctrl]+z
如果我们需要将某个程序扔到后台暂停一下比如vi，那直接按下[ctrl]+z就行，此时我们就会重新取得前台的控制权。此时，如果我们要查看后台的工作状况，可以使用`jobs`命令，这个命令加上`-l`参数还能一起显示每个job的PID。

- 将后台工作拿到前台来处理：fg
我们通过`fg &jobnumber`命令可以把后台的工作拿到前台处理。一般和jobs命令配合使用，毕竟要先知道jobnumer们。

- 让工作在后台下的状态变成运行中：bg  
[ctrl]+z可以将目前的工作丢到后台中去“暂停”(Stopped)，而`bg &jobnumber`命令可以让一个工作在后台里“Running”。  

- 删除后台当中的工作：kill  
`kill -signal PID`  
`kill -signal %jobnumber`
执行`kill -l`会列出目前kill能使用的信号。  
`kill -15`以正常的程序终止一项工作  
`kill -9`立刻强制删除一个工作  
## 脱机管理的问题
在上面工作管理中提到的“后台”指的是终端机模式下可以避免[ctrl]-c中断的一个情景，**并不是放到系统的后台中去**。在这样的情况下，如果你是以远程连接方式（ssh）连接到你的主机，比如连阿里云的主机，并将工作以&的方式放到后台，此时如果你关闭终端（脱机），那该工作就不会继续进行了，而是会被中断掉。  
如果想要把工作放到系统后台去，可以使用`at`或`nohub`命令。